<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>
    <link rel="stylesheet" href="cart.css">
    <link rel="stylesheet" href="styler.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="navbar">
        <div class="brand-name">Meow Meow</div>
        <div class="nav-icons">
            <a href="index.html"> HOME</a>
            <a href="index.html">ABOUT US</a>
            <div class="dropdown">
                <a href="index.html">PRODUCT</a>
                <div class="dropdown-content">
                    <a href="clothes.html">CLOTHES</a>
                    <a href="accessories.html">ACCESSORIES</a>
                    <a href="shoes.html">SHOES</a>
                    <a href="bags.html">BAGS</a>
                </div>
            </div>
            <a href="index.html">CONTACT</a>
            <a href="cart.html"><i class="fas fa-shopping-cart"></i></a>
            <a href="search.html"><i class="fas fa-search"></i></a>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row px-xl-5">
            <div class="col-lg-8">
                <h5 class="section-title position-relative text-uppercase mb-3"><br><br>
                    <span class="bg-secondary pr-3">Billing Address</span>
                </h5>
                <div class="bg-light p-30 mb-5">
                    <div class="row">
                        <div class="col-md-6 form-group">
                            <label>First Name</label>
                            <input class="form-control" type="text" placeholder="Alya" required>
                        </div>
                        <div class="col-md-6 form-group">
                            <label>Last Name</label>
                            <input class="form-control" type="text" placeholder="Syafiqah" required>
                        </div>
                        <div class="col-md-6 form-group">
                            <label>E-mail</label>
                            <input class="form-control" type="email" placeholder="example@gmail.com" required>
                        </div>
                        <div class="col-md-6 form-group">
                            <label>Mobile No</label>
                            <input class="form-control" type="text" placeholder="+60 12-345 6789" required>
                        </div>
                        <div class="col-md-6 form-group">
                            <label>Address Line 1</label>
                            <input class="form-control" type="text" placeholder="302, PU.PU, Putarannya" required>
                        </div>
                        <div class="col-md-6 form-group">
                            <label>Address Line 2</label>
                            <input class="form-control" type="text" placeholder="360, Gandingan 7 Berkembar">
                        </div>
                        <div class="col-md-6 form-group">
                            <label>Country</label>
                            <select class="custom-select">
                                <option>Australia</option>
                                <option>Brunei</option>
                                <option>Hong Kong</option>
                                <option>Indonesia</option>
                                <option selected>Malaysia</option>
                                <option>Myanmar</option>
                                <option>Philippines</option>
                                <option>Singapore</option>
                                <option>Taiwan</option>
                                <option>Thailand</option>
                            </select>
                        </div>
                        <div class="col-md-6 form-group">
                            <label>City</label>
                            <input class="form-control" type="text" placeholder="Nilai" required>
                        </div>
                        <div class="col-md-6 form-group">
                            <label>State</label>
                            <input class="form-control" type="text" placeholder="Negeri Sembilan" required>
                        </div>
                        <div class="col-md-6 form-group">
                            <label>ZIP Code</label>
                            <input class="form-control" type="text" placeholder="71800" required>
                        </div>
                        <div class="col-md-12 form-group">
                        </div>
                        <div class="col-md-12">
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" id="shipto">
                                <label class="custom-control-label" for="shipto" data-toggle="collapse"
                                    data-target="#shipping-address">Ship to different address</label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="collapse mb-5" id="shipping-address">
                    <h5 class="section-title position-relative text-uppercase mb-3">
                        <span class="bg-secondary pr-3">Shipping Address</span>
                    </h5>
                    <div class="bg-light p-30">
                        <div class="row">
                            <div class="col-md-6 form-group">
                                <label>First Name</label>
                                <input class="form-control" type="text" placeholder="Alya">
                            </div>
                            <div class="col-md-6 form-group">
                                <label>Last Name</label>
                                <input class="form-control" type="text" placeholder="Syafiqah">
                            </div>
                            <div class="col-md-6 form-group">
                                <label>E-mail</label>
                                <input class="form-control" type="email" placeholder="example@gmail.com">
                            </div>
                            <div class="col-md-6 form-group">
                                <label>Mobile No</label>
                                <input class="form-control" type="text" placeholder="+60 12-345 6789">
                            </div>
                            <div class="col-md-6 form-group">
                                <label>Address Line 1</label>
                                <input class="form-control" type="text" placeholder="302, PU.PU, Putarannya">
                            </div>
                            <div class="col-md-6 form-group">
                                <label>Address Line 2</label>
                                <input class="form-control" type="text" placeholder="360, Gandingan 7 Berkembar">
                            </div>
                            <div class="col-md-6 form-group">
                                <label>Country</label>
                                <select class="custom-select">
                                    <option>Australia</option>
                                    <option>Brunei</option>
                                    <option>Hong Kong</option>
                                    <option>Indonesia</option>
                                    <option selected>Malaysia</option>
                                    <option>Myanmar</option>
                                    <option>Philippines</option>
                                    <option>Singapore</option>
                                    <option>Taiwan</option>
                                    <option>Thailand</option>
                                </select>
                            </div>
                            <div class="col-md-6 form-group">
                                <label>City</label>
                                <input class="form-control" type="text" placeholder="Nilai">
                            </div>
                            <div class="col-md-6 form-group">
                                <label>State</label>
                                <input class="form-control" type="text" placeholder="Negeri Sembilan">
                            </div>
                            <div class="col-md-6 form-group">
                                <label>ZIP Code</label>
                                <input class="form-control" type="text" placeholder="71800">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
			
            <div class="col-lg-4">
                <h5 class="section-title position-relative text-uppercase mb-3"><br><br>
                    <span class="bg-secondary pr-3">Order Total</span>
                </h5>
                <div class="bg-light p-30 mb-5">
                    <div class="border-bottom" id="order-products">
                        <h6 class="mb-3">Products</h6>
                    </div>
                    <div class="border-bottom pt-3 pb-2">
                        <div class="d-flex justify-content-between mb-3">
                            <h6>Subtotal</h6>
                            <h6 id="order-subtotal">RM0</h6>
                        </div>
                        <div class="d-flex justify-content-between">
                            <h6 class="font-weight-medium">Shipping</h6>
                            <h6 class="font-weight-medium" id="order-shipping">RM10.00</h6>
                        </div>
                        <div class="d-flex justify-content-between discount-row" style="display: none !important;">
                            <h6 class="font-weight-medium text-success">Discount (10%)</h6>
                            <h6 class="font-weight-medium text-success" id="order-discount">-RM0</h6>
                        </div>
                    </div>
                    <div class="pt-2">
                        <div class="d-flex justify-content-between mt-2">
                            <h5>Total</h5>
                            <h5 id="order-total">RM0</h5>
                        </div>
                    </div>
                </div>
                <div class="mb-5">
                    <h5 class="section-title position-relative text-uppercase mb-3">
                        <span class="bg-secondary pr-3">Payment</span>
                    </h5>
                    <div class="bg-light p-30">
                        <div class="form-group">
                            <div class="custom-control custom-radio">
                                <input type="radio" class="custom-control-input" name="payment" id="paypal">
                                <label class="custom-control-label" for="paypal">Paypal</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="custom-control custom-radio">
                                <input type="radio" class="custom-control-input" name="payment" id="directcheck">
                                <label class="custom-control-label" for="directcheck">Direct Check</label>
                            </div>
                        </div>
                        <div class="form-group mb-4">
                            <div class="custom-control custom-radio">
                                <input type="radio" class="custom-control-input" name="payment" id="banktransfer">
                                <label class="custom-control-label" for="banktransfer">Bank Transfer</label>
                            </div>
                        </div>
                        <button class="btn btn-block btn-primary font-weight-bold py-3" id="place-order-btn">Place Order</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
	
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            function checkCart() {
                const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
                if (cartItems.length === 0) {
                    alert('Your cart is empty! Please add items to your cart first.');
                    window.location.href = 'index.html';
                    return false;
                }
                return true;
            }

            if (!checkCart()) return;
			
            function updateOrderSummary() {
                const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
                const orderTotal = JSON.parse(localStorage.getItem('orderTotal')) || {
                    subtotal: 0,
                    shipping: 10,
                    discount: 0,
                    total: 0,
                    discountApplied: false
                };

                const productsContainer = document.getElementById('order-products');
                if (productsContainer) {
                    const header = productsContainer.querySelector('h6.mb-3');
                    productsContainer.innerHTML = '';
                    productsContainer.appendChild(header);

                    cartItems.forEach(item => {
                        const productDiv = document.createElement('div');
                        productDiv.className = 'd-flex justify-content-between mb-2';
                        productDiv.innerHTML = `
                    <p>${item.name} x ${item.quantity || 1}</p>
                    <p>RM${((item.price * (item.quantity || 1))).toFixed(2)}</p>
                `;
                        productsContainer.appendChild(productDiv);
                    });
                }

                document.getElementById('order-subtotal').textContent = `RM${orderTotal.subtotal.toFixed(2)}`;
                document.getElementById('order-shipping').textContent = `RM${orderTotal.shipping.toFixed(2)}`;

                const discountRow = document.querySelector('.discount-row');
                const discountAmount = document.getElementById('order-discount');
                if (orderTotal.discountApplied) {
                    discountRow.style.cssText = 'display: flex !important';
                    discountAmount.textContent = `-$${orderTotal.discount.toFixed(2)}`;
                } else {
                    discountRow.style.cssText = 'display: none !important';
                }

                document.getElementById('order-total').textContent = `RM${orderTotal.total.toFixed(2)}`;
            }
            updateOrderSummary();

            const placeOrderBtn = document.getElementById('place-order-btn');
            if (placeOrderBtn) {
                placeOrderBtn.addEventListener('click', function (e) {
                    e.preventDefault();

                    if (!checkCart()) return;

                    const selectedPayment = document.querySelector('input[name="payment"]:checked');
                    if (!selectedPayment) {
                        alert('Please select a payment method');
                        return;
                    }

                    const requiredFields = document.querySelectorAll('.form-control[required]');
                    let isValid = true;

                    requiredFields.forEach(field => {
                        if (!field.value.trim()) {
                            field.classList.add('is-invalid');
                            isValid = false;
                        } else {
                            field.classList.remove('is-invalid');
                        }
                    });

                    if (!isValid) {
                        alert('Please fill in all required fields');
                        return;
                    }

                    const orderData = {
                        orderId: 'ORD-' + Date.now(),
                        orderDate: new Date().toISOString(),
                        items: JSON.parse(localStorage.getItem('cartItems')),
                        totals: JSON.parse(localStorage.getItem('orderTotal')),
                        paymentMethod: selectedPayment.id,
                        shippingDetails: getShippingDetails(),
                        billingDetails: getBillingDetails()
                    };
					
                    localStorage.setItem('lastOrder', JSON.stringify(orderData));

                    localStorage.removeItem('cart');
                    localStorage.removeItem('orderTotal');
                    localStorage.removeItem('discountApplied');

                    window.location.href = 'order-success.html';
                });
            }

            function getShippingDetails() {
                const shippingAddress = document.getElementById('shipping-address');
                if (shippingAddress && !shippingAddress.classList.contains('show')) {
                    return getBillingDetails();
                }

                return {
                    firstName: document.querySelector('#shipping-address input[placeholder="Alya"]')?.value,
                    lastName: document.querySelector('#shipping-address input[placeholder="Syafiqah"]')?.value,
                    email: document.querySelector('#shipping-address input[placeholder="example@gmail.com"]')?.value,
                    phone: document.querySelector('#shipping-address input[placeholder="+60 12-345 6789"]')?.value,
                    address1: document.querySelector('#shipping-address input[placeholder="302, PU.PU, Putarannya"]')?.value,
                    address2: document.querySelector('#shipping-address input[placeholder="360, Gandingan 7 Berkembar"]')?.value,
                    country: document.querySelector('#shipping-address select')?.value,
                    city: document.querySelector('#shipping-address input[placeholder="Nilai"]')?.value,
                    state: document.querySelector('#shipping-address input[placeholder="Negeri Sembilan"]')?.value,
                    zipCode: document.querySelector('#shipping-address input[placeholder="71800"]')?.value
                };
            }

            function getBillingDetails() {
                return {
                    firstName: document.querySelector('input[placeholder="Alya"]:not([id^="shipping-"])')?.value,
                    lastName: document.querySelector('input[placeholder="Syafiqah"]:not([id^="shipping-"])')?.value,
                    email: document.querySelector('input[placeholder="example@gmail.com"]:not([id^="shipping-"])')?.value,
                    phone: document.querySelector('input[placeholder="+60 12-345 6789"]:not([id^="shipping-"])')?.value,
                    address1: document.querySelector('input[placeholder="302, PU.PU, Putarannya"]:not([id^="shipping-"])')?.value,
                    address2: document.querySelector('input[placeholder="360, Gandingan 7 Berkembar"]:not([id^="shipping-"])')?.value,
                    country: document.querySelector('select:not([id^="shipping-"])')?.value,
                    city: document.querySelector('input[placeholder="Nilai"]:not([id^="shipping-"])')?.value,
                    state: document.querySelector('input[placeholder="Negeri Sembilan"]:not([id^="shipping-"])')?.value,
                    zipCode: document.querySelector('input[placeholder="71800"]:not([id^="shipping-"])')?.value
                };
            }
        });
    </script>
</body>
</html>
